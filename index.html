<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#000000"/>
    <link rel="apple-touch-icon" href="/icon.svg">
    <link rel="manifest" href="/manifest.json" />
    <link rel="icon" href="/icon.svg" />
    <title>Star Trek: Space Exploration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        /* Default theme is Federation */
        --color-bg-default: #0a0a12;
        --color-bg-paper: #111827; /* gray-900 */
        --color-bg-paper-lighter: #1f2937; /* gray-800 */
        --color-text-primary: #e0e0e0;
        --color-text-secondary: #a0a0a0;
        --color-text-disabled: #6b7280; /* gray-500 */
        --color-primary-main: #2563eb; /* blue-600 */
        --color-primary-light: #3b82f6; /* blue-500 */
        --color-primary-dark: #1d4ed8; /* blue-700 */
        --color-primary-text: #ffffff;
        --color-secondary-main: #06b6d4; /* cyan-500 */
        --color-secondary-light: #22d3ee; /* cyan-400 */
        --color-secondary-dark: #0891b2; /* cyan-600 */
        --color-secondary-text: #000000;
        --color-border-main: #60a5fa; /* blue-400 */
        --color-border-light: #22d3ee; /* cyan-400 */
        --color-border-dark: #083344; /* cyan-900 */
        --color-accent-yellow: #fde047;
        --color-accent-yellow-dark: #eab308; /* yellow-500 */
        --color-accent-yellow-darker: #a16207; /* yellow-700 */
        --color-accent-red: #ef4444;
        --color-accent-green: #22c55e;
        --color-accent-orange: #f97316;
        --color-accent-pink: #ec4899;
        --color-accent-purple: #a855f7;
        --color-accent-indigo: #4f46e5;
        --color-accent-sky: #0ea5e9;
        --color-accent-teal: #14b8a6;
        --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

        /* Shape & Border variables */
        --border-width-main: 2px;
        --border-width-button: 1px;
        --border-style-main: solid;
        --shape-border-radius-button: 0.375rem; /* rounded-md */
        --shape-border-radius-panel: 0.375rem;
        --panel-clip-path: none;
        --button-clip-path: none;

        background-color: var(--color-bg-default);
        color: var(--color-text-primary);
        font-family: var(--font-family);
      }
      
      .theme-federation {
        --color-bg-default: #000000;
        --color-bg-paper: #111111;
        --color-bg-paper-lighter: #222222;
        --color-text-primary: #e0e0e0;
        --color-text-secondary: #ff9900; /* LCARS Orange */
        
        --color-primary-main: #cc9966; /* LCARS Tan */
        --color-primary-light: #ddaa77;
        --color-primary-dark: #b88659; /* Cap color for primary */
        --color-primary-text: #000000;
        
        --color-secondary-main: #ffcc66; /* LCARS Gold */
        --color-secondary-light: #ffe088;
        --color-secondary-dark: #eebd59; /* Cap color for secondary */
        --color-secondary-text: #000000;
        
        --color-border-main: #ff9900; /* LCARS Orange */
        --color-border-light: #ffcc66; /* LCARS Gold */

        --shape-border-radius-button: 0; /* Let pseudo-elements handle radius */
        --shape-border-radius-panel: 0.75rem;
        --font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;

        /* New colors for LCARS targeting reticle */
        --color-lcars-blue-light: #a3bfdb;
        --color-lcars-blue-dark: #3d85c6;
        --color-lcars-gray: #7f8c8d;
      }
      
      .theme-klingon {
        --color-bg-default: #1c1917; /* stone-900 */
        --color-bg-paper: #292524; /* stone-800 */
        --color-bg-paper-lighter: #44403c; /* stone-700 */
        --color-text-primary: #e7e5e4; /* stone-200 */
        --color-text-secondary: #d6d3d1; /* stone-300 */
        --color-text-disabled: #78716c; /* stone-500 */
        --color-primary-main: #991b1b; /* red-800 */
        --color-primary-light: #b91c1c; /* red-700 */
        --color-primary-dark: #7f1d1d; /* red-900 */
        --color-primary-text: #fef08a; /* yellow-200 */
        --color-secondary-main: #facc15; /* yellow-400 */
        --color-secondary-light: #fde047; /* yellow-300 */
        --color-secondary-dark: #eab308; /* yellow-500 */
        --color-secondary-text: #000000;
        --color-border-main: #dc2626; /* red-600 */
        --color-border-light: #ca8a04; /* yellow-500 */
        --color-border-dark: #450a0a; /* red-950 */
        --color-accent-red: #dc2626; /* red-600 */
        --color-accent-green: #16a34a; /* green-600 */
        --color-accent-orange: #ea580c; /* orange-600 */
        --font-family: 'Georgia', serif;

        --border-width-main: 3px;
        --border-style-main: double;
        --shape-border-radius-button: 0px;
        --shape-border-radius-panel: 0px;
        --panel-clip-path: polygon(0 20px, 20px 0, calc(100% - 20px) 0, 100% 20px, 100% calc(100% - 20px), calc(100% - 20px) 100%, 20px 100%, 0 calc(100% - 20px));
        --button-clip-path: polygon(15% 0%, 85% 0%, 100% 50%, 85% 100%, 15% 100%, 0% 50%);
      }
      
      .theme-romulan {
        --color-bg-default: #000000;
        --color-plasma-green: #65f800;
        --color-lime-green: #a3e635;
        --color-dark-green: #166534;
        --color-darker-green: #103b22;

        --color-bg-paper: transparent;
        --color-bg-paper-lighter: #101c18;
        --color-text-primary: var(--color-plasma-green);
        --color-text-secondary: var(--color-lime-green);
        --color-text-disabled: #4d7c0f;
        
        --color-primary-main: var(--color-plasma-green);
        --color-primary-light: #bef264;
        --color-primary-dark: var(--color-dark-green);
        --color-primary-text: #000000;
        
        --color-secondary-main: var(--color-lime-green);
        --color-secondary-light: #d9f99d;
        --color-secondary-dark: #4d7c0f;
        --color-secondary-text: #000000;
        
        --color-border-main: var(--color-plasma-green);
        --color-border-light: var(--color-lime-green);
        --color-border-dark: var(--color-dark-green);
        
        --color-accent-green: var(--color-lime-green);
        --font-family: 'Courier New', monospace;

        --border-width-main: 0px;
        --border-style-main: solid;
        --shape-border-radius-button: 0px;
        --shape-border-radius-panel: 0px;
        --panel-clip-path: polygon(0 1rem, 1rem 0, calc(100% - 1rem) 0, 100% 1rem, 100% calc(100% - 1rem), calc(100% - 1rem) 100%, 1rem 100%, 0 calc(100% - 1rem));
        --button-clip-path: polygon(15% 0%, 100% 0%, 85% 100%, 0% 100%);
      }
      
      /* Main Menu Specific Backgrounds */
      .main-menu-bg {
        position: absolute;
        inset: 0;
        z-index: 0;
        pointer-events: none;
        opacity: 0.5;
      }

      @keyframes federation-map-scroll {
        from { background-position: 0 0, 0 0, 0 0, 0 0, 0 0; }
        to { background-position: 500px 500px, 500px 500px, 0 0, 0 0, 0 0; }
      }

      .theme-federation .main-menu-bg {
          background: 
              /* Faint grid lines */
              linear-gradient(rgba(100,100,200,0.15) 1px, transparent 1px),
              linear-gradient(90deg, rgba(100,100,200,0.15) 1px, transparent 1px),
              /* Faint targeting circles */
              radial-gradient(circle at 20% 30%, rgba(255,153,0,0.1) 0%, transparent 15%),
              radial-gradient(circle at 80% 70%, rgba(255,153,0,0.1) 0%, transparent 15%),
              /* Base color */
              #000;
          background-size: 50px 50px, 50px 50px, 100% 100%, 100% 100%, 100% 100%;
          animation: federation-map-scroll 60s linear infinite;
          opacity: 0.8;
      }


      @keyframes klingon-nebula-swirl {
        0% { background-position: 0% 50%; opacity: 0.4; }
        50% { background-position: 100% 50%; opacity: 0.6; }
        100% { background-position: 0% 50%; opacity: 0.4; }
      }

      .theme-klingon .main-menu-bg {
        background: radial-gradient(ellipse at 80% 20%, var(--color-accent-red), transparent 60%),
                    radial-gradient(ellipse at 20% 70%, var(--color-accent-orange), transparent 60%),
                    radial-gradient(ellipse at 50% 50%, #450a0a, var(--color-bg-default) 70%);
        background-size: 250% 250%;
        animation: klingon-nebula-swirl 25s ease-in-out infinite;
      }

      @keyframes romulan-plasma-swirl {
        0% { background-position: 0% 50%; opacity: 0.25; }
        50% { background-position: 100% 50%; opacity: 0.4; }
        100% { background-position: 0% 50%; opacity: 0.25; }
      }
      .theme-romulan .main-menu-bg {
        background: radial-gradient(ellipse at 70% 70%, var(--color-plasma-green), transparent 50%),
                    radial-gradient(ellipse at 30% 30%, var(--color-dark-green), transparent 50%),
                    radial-gradient(ellipse at 50% 50%, #000, var(--color-darker-green) 80%);
        background-size: 300% 300%;
        animation: romulan-plasma-swirl 30s ease-in-out infinite;
      }
      
      /* Klingon Title Style */
      .klingon-title {
        font-family: 'Georgia', serif;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        text-shadow: 2px 2px 0 var(--color-border-dark), 4px 4px 8px rgba(0,0,0,0.8);
        border-bottom: var(--border-width-main) var(--border-style-main) var(--color-border-main);
        border-top: var(--border-width-main) var(--border-style-main) var(--color-border-main);
        padding: 0.25rem 0;
        margin-bottom: 0.5rem;
      }

      /* Romulan Main Menu layout */
      .romulan-main-menu-grid {
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        grid-template-rows: auto 1fr auto;
        height: 100%;
        width: 100%;
        gap: 1rem;
        position: relative;
        z-index: 5;
      }

      /* Generic Component Styles */
      .panel-style {
        position: relative;
        border-width: var(--border-width-main);
        border-style: var(--border-style-main);
        border-color: var(--color-border-main);
        border-radius: var(--shape-border-radius-panel);
        background-color: var(--color-bg-paper);
        clip-path: var(--panel-clip-path);
      }
      
      .btn {
        padding: 0.5rem 1rem;
        font-weight: bold;
        transition: all 0.2s ease-in-out;
        border-radius: var(--shape-border-radius-button);
        clip-path: var(--button-clip-path);
        border: var(--border-width-button) solid transparent;
      }

      /* LCARS Button Styles */
      .theme-federation .btn {
          position: relative;
          padding-left: 2.55em; /* Increased padding to account for gap */
          font-weight: normal;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          clip-path: none;
          text-align: left;
          border-radius: 0;
          background-color: transparent !important; /* Key change: remove main bg */
          z-index: 1; /* Establish stacking context */
          border: none;
      }
      .theme-federation .btn::before,
      .theme-federation .btn::after {
          content: '';
          position: absolute;
          top: 0;
          bottom: 0;
          z-index: -1; /* Position behind text */
          transition: all 0.2s ease-in-out;
      }
      /* The rounded cap */
      .theme-federation .btn::before {
          left: 0;
          width: 1.75em; /* The cap width */
          border-radius: 1.75em 0 0 1.75em;
      }
      /* The rectangular body */
      .theme-federation .btn::after {
          left: 2.05em; /* Pushed right to create a 0.3em gap */
          right: 0;
          border-radius: 0 0.375rem 0.375rem 0;
      }
      
      /* Compact LCARS buttons for sidebar */
      .theme-federation .btn.btn-compact {
          padding-left: 1.8em; /* Increased padding */
          padding-right: 0.5em;
          min-height: 2.5em; 
          display: flex;
          align-items: center;
      }
      .theme-federation .btn.btn-compact::before {
          width: 1.2em;
          border-radius: 1.2em 0 0 1.2em;
      }
      .theme-federation .btn.btn-compact::after {
          left: 1.4em; /* Create a 0.2em gap */
      }
      .theme-klingon .btn.btn-compact {
        /* Restore horizontal padding to prevent text clipping from clip-path */
        padding-left: 2.5rem;
        padding-right: 2.5rem;
      }

      .theme-romulan .btn.btn-compact {
        /* Restore horizontal padding to prevent text clipping from clip-path */
        padding: 0.5rem 1.75rem;
      }

      .btn-primary {
        background-color: var(--color-primary-main);
        color: var(--color-primary-text);
        border-color: var(--color-primary-dark);
      }
      .btn-primary:hover:not(:disabled) {
        background-color: var(--color-primary-light);
      }
      .theme-federation .btn-primary { color: var(--color-primary-text); }
      .theme-federation .btn-primary::before { background-color: var(--color-primary-dark); }
      .theme-federation .btn-primary::after { background-color: var(--color-primary-main); }
      .theme-federation .btn-primary:hover:not(:disabled)::before { background-color: var(--color-primary-main); }
      .theme-federation .btn-primary:hover:not(:disabled)::after { background-color: var(--color-primary-light); }


      .btn-secondary {
        background-color: var(--color-secondary-main);
        color: var(--color-secondary-text);
        border-color: var(--color-secondary-dark);
      }
      .btn-secondary:hover:not(:disabled) {
          background-color: var(--color-secondary-light);
      }
      .theme-federation .btn-secondary { color: var(--color-secondary-text); }
      .theme-federation .btn-secondary::before { background-color: var(--color-secondary-dark); }
      .theme-federation .btn-secondary::after { background-color: var(--color-secondary-main); }
      .theme-federation .btn-secondary:hover:not(:disabled)::before { background-color: var(--color-secondary-main); }
      .theme-federation .btn-secondary:hover:not(:disabled)::after { background-color: var(--color-secondary-light); }

      .btn-tertiary {
        background-color: var(--color-bg-paper-lighter);
        color: var(--color-text-primary);
        border-color: var(--color-bg-paper);
      }
      .btn-tertiary:hover:not(:disabled) {
        filter: brightness(1.2);
      }
      .theme-federation .btn-tertiary { color: black; }
      .theme-federation .btn-tertiary::before { background-color: #7c7cb3; }
      .theme-federation .btn-tertiary::after { background-color: #9999cc; }
      .theme-federation .btn-tertiary:hover:not(:disabled) { filter: none; }
      .theme-federation .btn-tertiary:hover:not(:disabled)::before { background-color: #9999cc; }
      .theme-federation .btn-tertiary:hover:not(:disabled)::after { background-color: #a3a3d4; }
      
      .btn:disabled {
        background-color: var(--color-bg-paper-lighter) !important;
        color: var(--color-text-disabled) !important;
        cursor: not-allowed;
        filter: none !important;
        border-color: transparent !important;
      }
      /* Disabled Federation buttons maintain size but appear inactive */
      .theme-federation .btn:disabled {
          color: var(--color-text-disabled) !important;
      }
      .theme-federation .btn:disabled::before {
        background-color: #4a4a4a !important; /* Dark gray cap */
      }
      .theme-federation .btn:disabled::after {
        display: block !important;
        background-color: #3a3a3a !important; /* Slightly lighter gray body */
        left: 1.75em !important; /* Close the gap for a solid look */
      }
      .theme-federation .btn.btn-compact:disabled::after {
        left: 1.2em !important; /* Close the gap for compact disabled buttons */
      }
      
      .btn-accent { color: white; }
      .btn-accent.red { background-color: var(--color-accent-red); }
      .btn-accent.green { background-color: var(--color-accent-green); }
      .btn-accent.orange { background-color: var(--color-accent-orange); }
      .btn-accent.pink { background-color: var(--color-accent-pink); }
      .btn-accent.purple { background-color: var(--color-accent-purple); }
      .btn-accent.indigo { background-color: var(--color-accent-indigo); }
      .btn-accent.sky { background-color: var(--color-accent-sky); }
      .btn-accent.teal { background-color: var(--color-accent-teal); }
      .btn-accent:hover:not(:disabled) { filter: brightness(1.15); }

      /* LCARS Accent Buttons */
      .theme-federation .btn.btn-accent {
        background-color: transparent !important; /* Force override for accent color classes */
        color: black;
      }
      .theme-federation .btn-accent.red:not(:disabled)::before { background-color: #b35959; }
      .theme-federation .btn-accent.red:not(:disabled)::after { background-color: #cc6666; }

      .theme-federation .btn-accent.green:not(:disabled)::before { background-color: #59b386; }
      .theme-federation .btn-accent.green:not(:disabled)::after { background-color: #66cc99; }

      .theme-federation .btn-accent.orange:not(:disabled)::before { background-color: #e68a00; }
      .theme-federation .btn-accent.orange:not(:disabled)::after { background-color: #ff9900; }

      .theme-federation .btn-accent.sky:not(:disabled)::before { background-color: #5986b3; }
      .theme-federation .btn-accent.sky:not(:disabled)::after { background-color: #6699cc; }
      
      .theme-federation .btn-accent.yellow:not(:disabled)::before { background-color: #eebd59; }
      .theme-federation .btn-accent.yellow:not(:disabled)::after { background-color: #ffcc66; }
      
      .theme-federation .btn-accent.purple:not(:disabled)::before { background-color: #7c7cb3; }
      .theme-federation .btn-accent.purple:not(:disabled)::after { background-color: #9999cc; }
      
      .theme-federation .btn-accent.pink:not(:disabled)::before { background-color: #e68ab3; }
      .theme-federation .btn-accent.pink:not(:disabled)::after { background-color: #ff99cc; }
      
      .theme-federation .btn-accent.indigo:not(:disabled)::before { background-color: #5959b3; }
      .theme-federation .btn-accent.indigo:not(:disabled)::after { background-color: #6666cc; }

      .theme-federation .btn-accent.teal:not(:disabled)::before { background-color: #59b3e6; }
      .theme-federation .btn-accent.teal:not(:disabled)::after { background-color: #66ccff; }
      
      .theme-federation .btn-accent:hover:not(:disabled) { filter: none; }
      .theme-federation .btn-accent:hover:not(:disabled)::before,
      .theme-federation .btn-accent:hover:not(:disabled)::after {
          filter: brightness(1.1); 
      }
      
      @keyframes lcars-border-pulse {
        0%, 100% { opacity: 0; }
        50% { opacity: 0.7; }
      }
      @keyframes lcars-pulse-bg {
        0%, 100% { filter: brightness(1); }
        50% { filter: brightness(1.1); }
      }
      .theme-federation .panel-style::before {
        content: '';
        position: absolute;
        inset: calc(-1 * var(--border-width-main));
        border: var(--border-width-main) solid var(--color-border-light);
        border-radius: var(--shape-border-radius-panel);
        opacity: 0;
        animation: lcars-border-pulse 4s ease-in-out infinite;
        pointer-events: none;
        z-index: 1;
      }
      .theme-federation .btn:not(:disabled)::after,
      .theme-federation .btn:not(:disabled)::before {
        animation: lcars-pulse-bg 3s ease-in-out infinite;
      }
      .lcars-decoration {
        position: absolute;
        font-family: 'Courier New', monospace;
        color: var(--color-text-secondary);
        font-size: 0.7rem;
        text-transform: uppercase;
        pointer-events: none; /* Make them non-interactive */
        opacity: 0.8;
        z-index: 2; /* Ensure they are above panel pulse */
      }
      
      @keyframes red-alert-pulse-animation {
        0% { background-color: var(--color-bg-paper); }
        50% { background-color: #450a0a; } /* Dark Crimson Red */
        100% { background-color: var(--color-bg-paper); }
      }
      .red-alert-pulse {
        animation: red-alert-pulse-animation 2s ease-in-out infinite;
      }
      @keyframes klingon-red-alert-pulse {
        0%, 100% { box-shadow: inset 0 0 0 0px var(--color-accent-red); }
        50% { box-shadow: inset 0 0 40px 10px var(--color-accent-red); }
      }
      .theme-klingon.red-alert-pulse {
        animation: klingon-red-alert-pulse 1.5s ease-in-out infinite;
      }

      @keyframes wireframe-glow-animation {
        0%, 100% { filter: drop-shadow(0 0 2px var(--color-accent-yellow)); opacity: 0.8; }
        50% { filter: drop-shadow(0 0 5px var(--color-accent-yellow)); opacity: 1; }
      }
      .wireframe-glow {
        animation: wireframe-glow-animation 3s ease-in-out infinite;
      }

      /* Warp Animation Styles */
      .warp-container {
        position: absolute;
        inset: 0;
        background-color: #000;
        overflow: hidden;
        z-index: 100;
      }
      .stars-perspective {
        position: absolute;
        inset: 0;
        perspective: 400px;
        transform-style: preserve-3d;
      }
      .star {
        position: absolute;
        width: 3px;
        height: 3px;
        background: white;
        border-radius: 50%;
        animation: star-warp-animation infinite ease-in;
      }
      @keyframes star-warp-animation {
        from {
          transform: translateZ(-50px) scale(0.5);
          opacity: 0.5;
        }
        to {
          transform: translateZ(400px) scale(2);
          opacity: 0;
        }
      }
      .warp-flash {
        position: absolute;
        inset: 0;
        background-color: white;
        opacity: 0;
        animation: warp-flash-animation 2.5s ease-out;
      }
      @keyframes warp-flash-animation {
        0%, 90% { opacity: 0; }
        95%, 100% { opacity: 1; }
      }
      
      /* Combat FX Styles */
      .phaser-beam {
          animation: phaser-fire-animation 750ms ease-out forwards;
          stroke-dasharray: 2000;
          stroke-dashoffset: 2000;
      }
      .phaser-beam.federation {
          stroke: #ff4141; /* Red */
          filter: drop-shadow(0 0 3px #ff4141);
      }
      .phaser-beam.klingon {
          stroke: #22c55e; /* green-500 */
          filter: drop-shadow(0 0 3px #22c55e);
      }
      .phaser-beam.romulan {
          stroke: var(--color-plasma-green);
          filter: drop-shadow(0 0 5px var(--color-plasma-green));
      }
      .phaser-beam.pirate {
          stroke: var(--color-accent-orange);
          filter: drop-shadow(0 0 4px var(--color-accent-orange));
      }
      .torpedo-trail-dot {
          background-color: var(--color-accent-orange);
          border-radius: 50%;
      }
      .torpedo-explosion {
          position: absolute;
          transform: translate(-50%, -50%);
          border-radius: 50%;
          background-color: white;
          animation: torpedo-explosion-animation 0.75s ease-out forwards;
      }
      .phaser-impact {
        position: absolute;
        transform: translate(-50%, -50%);
        border-radius: 50%;
        animation: phaser-impact-animation 0.5s ease-out forwards;
        width: 3rem;
        height: 3rem;
      }
      .phaser-impact.shield {
        background: radial-gradient(circle, white, var(--color-secondary-light), transparent 70%);
      }
      .phaser-impact.hull {
        background: radial-gradient(circle, #fff700, var(--color-accent-orange), var(--color-accent-red), transparent 70%);
      }
      @keyframes phaser-fire-animation {
        /* Draw phase: 0-20% */
        0% {
            stroke-dashoffset: 2000;
            opacity: 1;
        }
        20% {
            stroke-dashoffset: 0;
            opacity: 1;
        }
        /* Hold/Flash phase: 20-50% */
        50% {
            stroke-dashoffset: 0;
            opacity: 1;
        }
        /* Fade phase: 50-100% */
        100% {
            stroke-dashoffset: 0;
            opacity: 0;
        }
      }

      /* New Pulse Phaser Bolt Style */
      .pulse-phaser-bolt {
        position: absolute; /* This needs to be here for the animation to work */
        width: 12px;
        height: 6px;
        border-radius: 50%;
      }
      .pulse-phaser-bolt.federation {
        background-color: var(--color-accent-yellow);
        box-shadow: 0 0 8px var(--color-accent-yellow-dark), 0 0 4px var(--color-accent-yellow);
      }
      .pulse-phaser-bolt.klingon {
        background-color: var(--color-accent-green);
        box-shadow: 0 0 8px var(--color-dark-green), 0 0 4px var(--color-accent-green);
      }
      
      /* Looping Phaser for Manual */
      @keyframes phaser-loop-animation {
        from { stroke-dashoffset: 200; opacity: 1; }
        to { stroke-dashoffset: 0; opacity: 0.7; }
      }
      .phaser-beam.phaser-beam-loop {
        /* Override the one-shot animation */
        animation: phaser-loop-animation 1s ease-in-out infinite alternate;
        stroke-dasharray: 200;
        stroke-dashoffset: 200;
      }
      /* Looping Pulse Phaser for Manual */
      @keyframes pulse-bolt-loop-animation {
        from {
          opacity: 1;
          transform: translateX(0px) scale(1) translateY(-50%);
        }
        to {
          opacity: 0;
          transform: translateX(200px) scale(0.5) translateY(-50%);
        }
      }
      .pulse-phaser-bolt-loop {
        position: absolute;
        animation: pulse-bolt-loop-animation 1.2s ease-in infinite;
      }

      @keyframes torpedo-explosion-animation {
        0% { transform: translate(-50%, -50%) scale(0.1); background-color: white; opacity: 1;}
        50% { background-color: var(--color-accent-orange); }
        100% { transform: translate(-50%, -50%) scale(1.5); background-color: var(--color-accent-red); opacity: 0; }
      }
      @keyframes phaser-impact-animation {
        0% { transform: translate(-50%, -50%) scale(0.2); opacity: 1; filter: brightness(2.0); }
        100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0; filter: brightness(1.0); }
      }
      
      @keyframes point-defense-fade {
        from { opacity: 0.8; }
        to { opacity: 0; }
      }
      .point-defense-beam {
        stroke-width: 2px;
        animation: point-defense-fade 0.3s ease-out forwards;
        opacity: 0;
      }
      .point-defense-beam.federation {
          stroke: #ff4141;
          fill: rgba(255, 65, 65, 0.3);
      }
      .point-defense-beam.klingon {
          stroke: #daa520;
          fill: rgba(218, 165, 32, 0.3);
      }
      .point-defense-beam.romulan {
          stroke: var(--color-plasma-green);
          fill: rgba(101, 248, 0, 0.3);
      }
      .point-defense-beam.pirate {
          stroke: var(--color-accent-orange);
          fill: rgba(249, 115, 22, 0.3);
      }

      /* LCARS Targeting Reticle */
      .bg-lcars-blue-light { background-color: var(--color-lcars-blue-light); }
      .bg-lcars-blue-dark { background-color: var(--color-lcars-blue-dark); }
      .bg-lcars-gray { background-color: var(--color-lcars-gray); }
      .bg-lcars-orange { background-color: var(--color-text-secondary); }
      .text-lcars-orange { color: var(--color-text-secondary); }

      @keyframes target-top-animation {
        from { transform: translateY(-100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      .animate-target-top { animation: target-top-animation 0.5s ease-out infinite alternate; }

      @keyframes target-bottom-animation {
        from { transform: translateY(100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      .animate-target-bottom { animation: target-bottom-animation 0.5s ease-out infinite alternate; }

      @keyframes target-left-animation {
        from { transform: translateX(-100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      .animate-target-left { animation: target-left-animation 0.5s ease-out infinite alternate; }

      @keyframes target-right-animation {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      .animate-target-right { animation: target-right-animation 0.5s ease-out infinite alternate; }

      /* Klingon UI Enhancements */
      .theme-klingon .btn {
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        /* Symmetrical padding for clipped shape, increased to avoid clipping */
        padding-left: 2.5rem;
        padding-right: 2.5rem;
      }
      .theme-klingon .tactical-grid .btn {
        justify-content: flex-start; /* Left-align content for tactical buttons */
        text-align: left;
        padding-left: calc(15% + 1rem);
        padding-right: 2rem;
      }
      .theme-klingon .klingon-quad-cell {
        position: relative;
      }
      .theme-klingon .klingon-quad-cell::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to top right, transparent 49.5%, var(--color-border-dark) 49.5%, var(--color-border-dark) 50.5%, transparent 50.5%);
        pointer-events: none;
        opacity: 0.7;
      }
      .klingon-sector-grid-overlay {
        position: absolute;
        inset: 0;
        background-image:
            linear-gradient(120deg, var(--color-border-dark) 1px, transparent 1px),
            linear-gradient(60deg, var(--color-border-dark) 1px, transparent 1px),
            linear-gradient(0deg, var(--color-border-dark) 1px, transparent 1px);
        background-size: 3rem 5.2rem;
        opacity: 0.25;
        pointer-events: none;
        z-index: 1;
        border-radius: 0 0.375rem 0.375rem 0;
      }
      .klingon-reticle-bracket {
        transform-origin: center;
        animation: klingon-target-pulse 1.5s ease-in-out infinite;
        stroke: var(--color-accent-red);
        stroke-width: 3;
        fill: none;
        filter: drop-shadow(0 0 3px var(--color-accent-red));
      }
      @keyframes klingon-target-pulse {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.1) rotate(2deg); opacity: 0.7; }
      }
      
      /* Klingon Energy Allocator */
      .klingon-allocator-svg {
        cursor: crosshair;
        touch-action: none;
      }
      .klingon-allocator-triangle-bg {
        fill: var(--color-bg-paper-lighter);
        stroke: var(--color-border-dark);
        stroke-width: 1;
      }
      .klingon-allocator-triangle-outline {
        fill: none;
        stroke: var(--color-primary-main);
        stroke-width: 2;
        stroke-linejoin: round;
      }
      .klingon-allocator-handle {
        fill: url(#klingon-handle-gradient);
        stroke: var(--color-accent-red);
        stroke-width: 1.5;
        cursor: grab;
        transition: all 0.1s ease;
      }
      .klingon-allocator-handle:active {
        cursor: grabbing;
        r: 8;
        filter: drop-shadow(0 0 5px var(--color-accent-red));
      }
      .klingon-allocator-label {
        font-family: var(--font-family);
        fill: var(--color-text-secondary);
        font-size: 10px;
        font-weight: bold;
        text-anchor: middle;
        text-transform: uppercase;
        pointer-events: none;
        letter-spacing: 1px;
        -webkit-user-select: none; /* Safari */
        -ms-user-select: none; /* IE 10+ */
        user-select: none; /* Standard syntax */
      }

      /* Romulan UI Enhancements */
      .theme-romulan .panel-style {
          background-color: transparent;
          border-width: 0;
          box-shadow: 0 0 0 1px var(--color-plasma-green), 0 0 0 3px var(--color-darker-green);
      }
      .theme-romulan .panel-style::before {
          content: '';
          position: absolute;
          inset: 0;
          clip-path: var(--panel-clip-path);
          box-shadow: inset 0 0 20px var(--color-dark-green);
          pointer-events: none;
          z-index: -1;
      }
      .theme-romulan .panel-style::after {
        content: '';
        position: absolute;
        inset: 0;
        background-image:
          linear-gradient(var(--color-dark-green) 1px, transparent 1px),
          linear-gradient(to right, var(--color-dark-green) 1px, transparent 1px);
        background-size: 2rem 2rem;
        opacity: 0.2;
        pointer-events: none;
        clip-path: var(--panel-clip-path);
      }
      .theme-romulan .btn {
          background-color: var(--color-darker-green);
          color: var(--color-plasma-green);
          border: 1px solid var(--color-dark-green);
          box-shadow: 0 0 0 1px var(--color-dark-green);
          text-transform: uppercase;
          text-align: center;
          /* CHANGE: Added flex properties for centering and increased horizontal padding for slant */
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.5rem 1.75rem;
      }
      .theme-romulan .btn:hover:not(:disabled) {
          background-color: var(--color-dark-green);
          color: white;
          border-color: var(--color-dark-green);
          box-shadow: 0 0 0 1px var(--color-lime-green), 0 0 10px var(--color-plasma-green);
          transform: translateY(-1px) scale(1.02);
      }
       .theme-romulan .btn:disabled {
          background-color: transparent !important;
          color: var(--color-text-disabled) !important;
          box-shadow: 0 0 0 1px var(--color-text-disabled);
          border-color: transparent;
          transform: none;
      }

      /* Romulan HUD Frame */
      .romulan-frame-decoration {
        position: absolute;
        z-index: 0; /* Behind UI but above background */
        pointer-events: none;
        color: var(--color-plasma-green);
      }
      @keyframes romulan-flicker {
        0%, 100% { opacity: 0.6; }
        50% { opacity: 0.75; }
      }
      .romulan-frame-decoration svg {
        position: absolute;
        overflow: visible;
        animation: romulan-flicker 5s ease-in-out infinite;
      }
      .romulan-frame-decoration svg path, 
      .romulan-frame-decoration svg line,
      .romulan-frame-decoration svg rect,
      .romulan-frame-decoration svg polyline,
      .romulan-frame-decoration svg polygon {
          stroke: var(--color-plasma-green);
          stroke-width: 2;
          fill: none;
      }
      .romulan-frame-decoration svg .border-inner {
        stroke-width: 1px;
        stroke: var(--color-dark-green);
      }
      .romulan-frame-decoration svg text {
          fill: var(--color-plasma-green);
          font-family: var(--font-family);
          font-size: 14px;
          text-transform: uppercase;
      }
      
      @keyframes romulan-target-pulse {
        0%, 100% { stroke-opacity: 0.6; transform: scale(0.98); }
        50% { stroke-opacity: 1; transform: scale(1.02); }
      }
      .romulan-reticle-bracket {
        stroke: var(--color-plasma-green);
        stroke-width: 2;
        fill: none;
        animation: romulan-target-pulse 1.5s ease-in-out infinite;
        transform-origin: center;
        filter: drop-shadow(0 0 4px var(--color-plasma-green));
      }

      /* Desperation Move Animation - Klingon Ram */
      @keyframes ram-animation-source {
        0% { left: -20%; top: 35%; transform: translate(-50%, -50%) rotate(-25deg); opacity: 1; }
        60% { left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(0deg); opacity: 1; }
        61%, 100% { opacity: 0; }
      }
      @keyframes ram-animation-target {
          0%, 60% { transform: scale(1) rotate(0deg); opacity: 1; }
          65% { transform: scale(1.2) rotate(15deg); opacity: 1; }
          70%, 100% { transform: scale(0); opacity: 0; }
      }
      @keyframes ram-animation-explosion {
          0%, 60% { transform: scale(0); opacity: 0; }
          61% { transform: scale(0.1); opacity: 1; }
          100% { transform: scale(2.5); opacity: 0; }
      }
      .ram-animation-source {
          animation: ram-animation-source 3s ease-in forwards;
      }
      .ram-animation-target {
          animation: ram-animation-target 3s ease-out forwards;
      }
      .ram-animation-explosion {
          width: 15rem;
          height: 15rem;
          border-radius: 50%;
          background: radial-gradient(circle, white, var(--color-accent-yellow), var(--color-accent-orange), var(--color-accent-red));
          animation: ram-animation-explosion 3s ease-out forwards;
      }

      /* Desperation Move Animation - Romulan Escape */
      @keyframes romulan-escape-charge {
        0% { transform: scale(0.8); opacity: 0; filter: brightness(1); }
        20% { transform: scale(1); opacity: 1; filter: brightness(1.5); }
        40% { transform: translate(-1px, 1px) scale(1.05); filter: brightness(2); }
        60% { transform: translate(1px, -1px) scale(1.05); filter: brightness(2.5); }
        80%, 100% { transform: translate(0, 0) scale(1.1); opacity: 1; filter: brightness(3); }
      }
      @keyframes romulan-escape-success {
        from { transform: scale(1.1, 1.1); opacity: 1; }
        to { transform: scale(5, 0.1); opacity: 0; }
      }
      @keyframes romulan-escape-failure-ship {
        0% { opacity: 1; transform: scale(1.1); filter: brightness(3); }
        5% { opacity: 1; transform: scale(1.5); filter: brightness(5); }
        10%, 100% { opacity: 0; transform: scale(0); }
      }
      @keyframes romulan-escape-failure-explosion {
        0%, 60% { transform: scale(0); opacity: 0; }
        61% { transform: scale(0.1); opacity: 1; }
        100% { transform: scale(2.5); opacity: 0; }
      }
      .romulan-escape-ship.success {
        animation: romulan-escape-charge 2.5s ease-in-out forwards, romulan-escape-success 0.5s 2.5s ease-in forwards;
      }
      .romulan-escape-ship.failure {
        animation: romulan-escape-charge 2.5s ease-in-out forwards, romulan-escape-failure-ship 0.5s 2.5s ease-out forwards;
      }
      .romulan-escape-explosion {
        width: 15rem;
        height: 15rem;
        border-radius: 50%;
        background: radial-gradient(circle, white, var(--color-lime-green), var(--color-plasma-green), var(--color-dark-green));
        animation: romulan-escape-failure-explosion 0.8s 2.5s ease-out forwards;
        transform: scale(0); /* Initially hidden */
      }

      /* Desperation Move Animation - Pirate Self-Destruct */
      @keyframes pirate-overload {
        0% { transform: scale(1) rotate(0deg); filter: brightness(1) drop-shadow(0 0 2px var(--color-accent-orange)); }
        25% { transform: scale(1.05) rotate(-2deg); filter: brightness(2) drop-shadow(0 0 8px white); }
        50% { transform: scale(0.95) rotate(2deg); filter: brightness(1.5) drop-shadow(0 0 4px var(--color-accent-red)); }
        75% { transform: scale(1.1) rotate(0deg); filter: brightness(3) drop-shadow(0 0 12px white); }
        100% { transform: scale(1.1); filter: brightness(3) drop-shadow(0 0 12px white); }
      }

      @keyframes pirate-vanish {
        to { transform: scale(0); opacity: 0; }
      }

      @keyframes pirate-explosion {
        0% { transform: scale(0); opacity: 0; }
        1% { transform: scale(0.1); opacity: 1; }
        100% { transform: scale(3); opacity: 0; }
      }

      .pirate-self-destruct-ship {
        animation: pirate-overload 2.5s ease-in-out forwards, pirate-vanish 0.1s 2.5s forwards;
      }

      .pirate-self-destruct-explosion {
        width: 15rem;
        height: 15rem;
        border-radius: 50%;
        background: radial-gradient(circle, white, var(--color-accent-yellow), var(--color-accent-orange), var(--color-accent-red));
        animation: pirate-explosion 0.8s 2.5s ease-out forwards;
        transform: scale(0); /* Initially hidden */
      }

      /* Desperation Move Animation - Federation Evacuate */
      @keyframes fed-evac-shuttle-1 {
        0% { transform: translate(0, 0) scale(0.5); opacity: 0; }
        10% { transform: translate(0, 0) scale(1); opacity: 1; }
        100% { transform: translate(-150px, -200px) scale(0.5); opacity: 0; }
      }
      @keyframes fed-evac-shuttle-2 {
        0%, 10% { transform: translate(0, 0) scale(0.5); opacity: 0; }
        20% { transform: translate(0, 0) scale(1); opacity: 1; }
        100% { transform: translate(180px, -150px) scale(0.5); opacity: 0; }
      }
      @keyframes fed-evac-shuttle-3 {
        0%, 20% { transform: translate(0, 0) scale(0.5); opacity: 0; }
        30% { transform: translate(0, 0) scale(1); opacity: 1; }
        100% { transform: translate(-100px, 200px) scale(0.5); opacity: 0; }
      }
      @keyframes fed-evac-shuttle-4 {
        0%, 30% { transform: translate(0, 0) scale(0.5); opacity: 0; }
        40% { transform: translate(0, 0) scale(1); opacity: 1; }
        100% { transform: translate(200px, 180px) scale(0.5); opacity: 0; }
      }

      .fed-evac-shuttle-1 { animation: fed-evac-shuttle-1 3s 0s ease-out forwards; }
      .fed-evac-shuttle-2 { animation: fed-evac-shuttle-2 3s 0.2s ease-out forwards; }
      .fed-evac-shuttle-3 { animation: fed-evac-shuttle-3 3s 0.4s ease-out forwards; }
      .fed-evac-shuttle-4 { animation: fed-evac-shuttle-4 3s 0.6s ease-out forwards; }
      .fed-evac-shuttle-5 { animation: fed-evac-shuttle-1 3s 0.8s ease-out forwards; } /* reuse for simplicity */


      @keyframes fed-evac-ship-hold {
        0%, 60% { opacity: 1; transform: translate(0,0) rotate(0deg); }
        61% { opacity: 0; }
        100% { opacity: 0; }
      }
      .fed-evac-ship-hold {
        animation: fed-evac-ship-hold 4s forwards;
      }


      @keyframes fed-evac-saucer-drift {
        0%, 60% { opacity: 0; transform: translate(0, 0) rotate(0deg); }
        61% { opacity: 1; }
        100% { opacity: 1; transform: translate(-40px, -20px) rotate(-15deg); }
      }
      .fed-evac-saucer-drift {
        animation: fed-evac-saucer-drift 4s ease-out forwards;
      }

      @keyframes fed-evac-engineering-drift {
        0%, 60% { opacity: 0; transform: translate(0, 0) rotate(0deg); }
        61% { opacity: 1; }
        100% { opacity: 1; transform: translate(40px, 20px) rotate(10deg); }
      }
      .fed-evac-engineering-drift {
        animation: fed-evac-engineering-drift 4s ease-out forwards;
      }

      /* Nebula Background */
      @keyframes nebula-swirl {
        0% {
          background-position: 0% 50%;
          opacity: 0.3;
        }
        50% {
          background-position: 100% 50%;
          opacity: 0.45;
        }
        100% {
          background-position: 0% 50%;
          opacity: 0.3;
        }
      }
      .nebula-background {
        position: absolute;
        inset: 0;
        z-index: 0;
        pointer-events: none;
        background: radial-gradient(ellipse at 40% 60%, var(--color-accent-pink), transparent 70%),
                    radial-gradient(ellipse at 70% 30%, var(--color-accent-sky), transparent 70%),
                    radial-gradient(ellipse at 20% 20%, var(--color-accent-purple), transparent 70%);
        background-size: 300% 300%;
        animation: nebula-swirl 20s ease-in-out infinite;
      }

      /* Nebula Cell Style */
      .nebula-cell {
          position: absolute;
          width: 100%;
          height: 100%;
          background: radial-gradient(ellipse at center, 
              rgba(167, 139, 250, 0.3) 0%, /* purple-400 */
              rgba(236, 72, 153, 0.2) 50%, /* pink-500 */
              rgba(14, 165, 233, 0.1) 100%); /* sky-500 */
          opacity: 0.6;
          pointer-events: none;
          z-index: 5;
          animation: nebula-cell-swirl 15s ease-in-out infinite alternate;
          clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
      }

      @keyframes nebula-cell-swirl {
          from {
              background-position: 0% 50%;
              filter: brightness(0.9);
          }
          to {
              background-position: 100% 50%;
              filter: brightness(1.1);
          }
      }

      .deep-nebula-overlay {
          position: absolute;
          width: 100%;
          height: 100%;
          background-color: rgba(6, 78, 99, 0.4); /* cyan-800 with opacity */
          box-shadow: inset 0 0 15px rgba(34, 211, 238, 0.5); /* cyan-400 */
          z-index: 6; /* Above regular nebula cells */
          pointer-events: none;
          animation: deep-nebula-pulse 5s ease-in-out infinite;
          clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
      }

      /* Ion Storm Styles */
      @keyframes ion-storm-swirl {
        0% {
          background-position: 0% 50%;
          opacity: 0.4;
          filter: brightness(1.0);
        }
        48% {
          opacity: 0.6;
        }
        50% {
          background-position: 100% 50%;
          opacity: 0.2;
          filter: brightness(2.0) saturate(2.0);
        }
        52% {
          opacity: 0.6;
        }
        100% {
          background-position: 0% 50%;
          opacity: 0.4;
          filter: brightness(1.0);
        }
      }
      .ion-storm-background {
        position: absolute;
        inset: 0;
        z-index: 0;
        pointer-events: none;
        background: radial-gradient(ellipse at 40% 60%, var(--color-accent-teal), transparent 70%),
                    radial-gradient(ellipse at 70% 30%, var(--color-accent-green), transparent 70%),
                    radial-gradient(ellipse at 20% 20%, var(--color-accent-yellow), transparent 70%);
        background-size: 250% 250%;
        animation: ion-storm-swirl 8s ease-in-out infinite;
      }
      .ion-storm-cell {
          position: absolute;
          width: 100%;
          height: 100%;
          background: radial-gradient(ellipse at center, 
              rgba(255, 255, 255, 0.3) 0%,
              rgba(163, 230, 53, 0.2) 50%, /* lime-green */
              rgba(20, 184, 166, 0.1) 100%); /* teal */
          opacity: 0.7;
          pointer-events: none;
          z-index: 5;
          animation: ion-storm-cell-swirl 7s ease-in-out infinite alternate;
          clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
      }
      @keyframes ion-storm-cell-swirl {
          from {
              background-position: 0% 50%;
              filter: brightness(0.8) contrast(1.2);
          }
          to {
              background-position: 100% 50%;
              filter: brightness(1.2) contrast(1.0);
          }
      }
      .deep-ion-storm-overlay {
          position: absolute;
          width: 100%;
          height: 100%;
          background-color: rgba(163, 230, 53, 0.4); /* lime-green with opacity */
          box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.6);
          z-index: 6;
          pointer-events: none;
          animation: deep-nebula-pulse 2s ease-in-out infinite; /* reuse deep nebula pulse */
          clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
      }

      @keyframes deep-nebula-pulse {
          0%, 100% {
              opacity: 0.7;
          }
          50% {
              opacity: 0.9;
          }
      }

      /* Scenario Simulator Allegiance Buttons */
      .btn-allegiance-inactive {
        filter: brightness(0.6) saturate(0.8);
        transition: filter 0.2s ease-in-out;
      }
      .btn-allegiance-inactive:hover:not(:disabled) {
        filter: brightness(0.8) saturate(1);
      }
      @keyframes allegiance-pulse {
        0%, 100% { filter: brightness(1.05) saturate(1.1); }
        50% { filter: brightness(1.25) saturate(1.2); }
      }
      .btn-allegiance-active {
        filter: brightness(1.05) saturate(1.1);
        animation: allegiance-pulse 2s ease-in-out infinite;
      }
      
      /* New Main Menu Styles */
      .federation-main-menu-grid {
        display: grid;
        grid-template-columns: 350px 1fr; /* LCARS sidebar and main content */
        grid-template-rows: auto 1fr auto; /* Header, content, footer */
        height: 100%;
        width: 100%;
        gap: 1rem;
        padding: 1rem;
        position: relative;
        z-index: 5;
      }

      @keyframes federation-logo-pulse {
        0%, 100% { filter: drop-shadow(0 0 5px var(--color-primary-light)) brightness(1); }
        50% { filter: drop-shadow(0 0 15px var(--color-primary-light)) brightness(1.2); }
      }

      .federation-logo-animated {
        animation: federation-logo-pulse 6s ease-in-out infinite;
      }
      
      .theme-klingon .btn:hover:not(:disabled) {
        background-color: var(--color-primary-light);
        transform: scale(1.05);
        text-shadow: 0 0 8px var(--color-secondary-light);
      }

      .klingon-btn-swap .klingon-text {
          font-family: 'Georgia', serif;
          display: inline;
      }
      .klingon-btn-swap .english-text {
          display: none;
          /* Use a more standard "computer" font for the translation */
          font-family: 'Courier New', monospace; 
          font-weight: normal;
          text-transform: uppercase;
          letter-spacing: 0.1em;
      }
      .klingon-btn-swap:hover:not(:disabled) .klingon-text {
          display: none;
      }
      .klingon-btn-swap:hover:not(:disabled) .english-text {
          display: inline;
      }

      @keyframes klingon-logo-flare {
        0%, 100% { 
            filter: drop-shadow(0 0 15px var(--color-accent-red)) brightness(1); 
            transform: scale(1);
        }
        50% { 
            filter: drop-shadow(0 0 30px white) drop-shadow(0 0 20px var(--color-accent-red)) brightness(1.5); 
            transform: scale(1.03);
        }
      }

      .klingon-logo-animated {
        animation: klingon-logo-flare 2.5s ease-in-out infinite;
      }

      @keyframes wireframe-warbird-rotate {
        from { transform: rotateY(-20deg) rotateX(15deg) scale(1.4); }
        to { transform: rotateY(340deg) rotateX(15deg) scale(1.4); }
      }

      .romulan-warbird-bg {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 60vmin;
        height: 60vmin;
        transform-style: preserve-3d;
        perspective: 1000px;
        z-index: 1;
        opacity: 0.2;
      }
      .romulan-warbird-bg > svg {
         animation: wireframe-warbird-rotate 120s linear infinite;
      }

      .theme-romulan .romulan-main-menu-grid .btn:hover:not(:disabled) {
          text-shadow: 0 0 8px var(--color-plasma-green), 0 0 12px white;
          box-shadow: 0 0 0 1px var(--color-lime-green), 0 0 15px var(--color-plasma-green);
      }

      .romulan-main-menu-wrapper {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      .romulan-main-menu-wrapper::after {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: repeating-linear-gradient(
              0deg,
              rgba(101, 248, 0, 0) 0,
              rgba(101, 248, 0, 0.08) 1.5px,
              rgba(101, 248, 0, 0) 3px
          );
          animation: scanline-effect 10s linear infinite;
          pointer-events: none;
          z-index: 2;
      }

      @keyframes scanline-effect {
          0% { background-position: 0 0; }
          100% { background-position: 0 100vh; }
      }

      .quadrant-indicator {
        width: 0.375rem; /* w-1.5 */
        height: 0.375rem; /* h-1.5 */
        border-radius: 9999px; /* rounded-full */
      }
      
      /* New Hex Grid Styles */
      .hex-grid-bg polygon {
        fill: transparent;
        stroke: var(--color-border-dark);
        stroke-opacity: 0.5;
        stroke-width: 1px;
      }
      .hex-cell {
        fill: transparent;
        stroke: transparent;
        transition: fill 0.2s ease-in-out;
      }
      .hex-cell.navigable:hover {
        fill: var(--color-secondary-light);
        fill-opacity: 0.2;
        cursor: pointer;
      }
      .hex-cell.occupied {
        cursor: default;
      }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'bg-default': 'var(--color-bg-default)',
              'bg-paper': 'var(--color-bg-paper)',
              'bg-paper-lighter': 'var(--color-bg-paper-lighter)',
              'text-primary': 'var(--color-text-primary)',
              'text-secondary': 'var(--color-text-secondary)',
              'text-disabled': 'var(--color-text-disabled)',
              'primary-main': 'var(--color-primary-main)',
              'primary-light': 'var(--color-primary-light)',
              'primary-dark': 'var(--color-primary-dark)',
              'primary-text': 'var(--color-primary-text)',
              'secondary-main': 'var(--color-secondary-main)',
              'secondary-light': 'var(--color-secondary-light)',
              'secondary-dark': 'var(--color-secondary-dark)',
              'secondary-text': 'var(--color-secondary-text)',
              'border-main': 'var(--color-border-main)',
              'border-light': 'var(--color-border-light)',
              'border-dark': 'var(--color-border-dark)',
              'accent-yellow': 'var(--color-accent-yellow)',
              'accent-yellow-dark': 'var(--color-accent-yellow-dark)',
              'accent-yellow-darker': 'var(--color-accent-yellow-darker)',
              'accent-red': 'var(--color-accent-red)',
              'accent-green': 'var(--color-accent-green)',
              'accent-orange': 'var(--color-accent-orange)',
              'accent-pink': 'var(--color-accent-pink)',
              'accent-purple': 'var(--color-accent-purple)',
              'accent-indigo': 'var(--color-accent-indigo)',
              'accent-sky': 'var(--color-accent-sky)',
              'accent-teal': 'var(--color-accent-teal)',
               /* New colors for LCARS targeting reticle */
              'lcars-blue-light': 'var(--color-lcars-blue-light)',
              'lcars-blue-dark': 'var(--color-lcars-blue-dark)',
              'lcars-gray': 'var(--color-lcars-gray)',
              'lcars-orange': 'var(--color-text-secondary)',
            }
          }
        }
      }
    </script>
  <script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.20.0",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/"
  }
}
</script>
</head>
  <body>
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').then(registration => {
            console.log('SW registered: ', registration);
          }).catch(registrationError => {
            console.log('SW registration failed: ', registrationError);
          });
        });
      }
    </script>
  </body>
</html>